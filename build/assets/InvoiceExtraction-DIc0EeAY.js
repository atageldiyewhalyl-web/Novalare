import{r as o,j as e,a as x,U as O,F as G,d as de,C as oe,t as n,p as me,b as xe,E as pe,$ as ue,D as he,M as ge}from"./index-DrBwAU1T.js";import{B as z}from"./badge-BVkw5bJj.js";import{S as X,a as H,b as J,c as K,d as v}from"./select-BpfYsr0G.js";import{C as q}from"./checkbox-DjjqsiJl.js";import{i as U,d as Q,a as be,c as je}from"./api-client-BUzUkZPR.js";import{D as ve,a as fe,b as ye,c as Ne,d as we,e as ke}from"./dialog-vf0qvQXb.js";import{C as Se}from"./circle-x-9GgX3eVg.js";import{D as De,a as Ce,g as W,b as Ee,c as Y}from"./DevPortal--LMNXygJ.js";import{B as Ie}from"./building-Cu8HYSb7.js";import{E as Fe}from"./eye-_8xTnK9v.js";import{T as Te}from"./trash-2-CxXCVqKn.js";import"./index-BSRUjdZ4.js";function Ae({companyId:f,onSuccess:s,onOpenChange:l}){const[y,E]=o.useState(!1),[p,u]=o.useState(null),[w,R]=o.useState(!1),[r,k]=o.useState(null),[S,b]=o.useState(null),D=o.useRef(null),h=i=>{const c=i.target.files?.[0];if(c){if(!["application/pdf","image/png","image/jpeg","image/jpg"].includes(c.type)){n.error("Please upload a PDF or image file (PNG, JPG)");return}if(c.size>10*1024*1024){n.error("File size must be less than 10MB");return}u(c),b(null)}},I=i=>{i.preventDefault();const c=i.dataTransfer.files[0];c&&h({target:{files:[c]}})},P=i=>{i.preventDefault()},_=async()=>{if(p){R(!0),b(null);try{const i=new FormData;i.append("file",p);const c=`https://${me}.supabase.co/functions/v1/make-server-53c2e113/analyze-invoice`,g=await fetch(c,{method:"POST",headers:{Authorization:`Bearer ${xe}`},body:i}),N=await g.json();if(g.ok)k(N),n.success("Invoice extracted successfully! ðŸŽ‰");else throw new Error(N.error||`Server responded with ${g.status}`)}catch(i){const c=i.message||"Failed to process invoice. Please try again.";b(c),n.error(c),console.error("Upload error:",i)}finally{R(!1)}}},$=async()=>{if(!(!r||!p))try{n.loading("Checking for duplicates...");const c=(await U.getByCompany(f)).find(T=>T.invoiceNumber?.toLowerCase()===r.invoice_number?.toLowerCase()&&T.vendor?.toLowerCase()===r.supplier_name?.toLowerCase());if(c&&(n.dismiss(),!confirm(`âš ï¸ DUPLICATE DETECTED!

Invoice "${r.invoice_number}" from "${r.supplier_name}" already exists.

Existing: ${c.currency||"EUR"} ${c.gross} (${c.date})
New: ${r.currency} ${r.total_amount} (${r.invoice_date})

Do you want to save it anyway?`))){n.info("Invoice upload cancelled");return}n.loading("Saving invoice and uploading file...");const g=await Q.uploadFile(f,p);await U.create(f,{documentName:p.name,vendor:r.supplier_name,invoiceNumber:r.invoice_number,date:r.invoice_date,dueDate:r.due_date,net:r.net_amount,vat:r.vat_amount,gross:r.total_amount,currency:r.currency,category:"General Expense",status:"Pending",fileUrl:g}),await Q.create(f,{name:p.name,type:"Invoice",status:"Processed",fileUrl:g});const N=new Date;await be.create(f,{action:`Processed invoice: ${r.supplier_name} - ${r.currency} ${r.total_amount}`,date:N.toISOString().split("T")[0],time:N.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}),n.dismiss(),n.success("Invoice saved and file uploaded successfully!"),u(null),k(null),b(null),E(!1),s&&s()}catch(i){console.error("Failed to save invoice:",i),n.error("Failed to save invoice")}},C=()=>{u(null),k(null),b(null),D.current&&(D.current.value="")},F=()=>{C(),E(!1),l&&l(!1)};return e.jsxs(ve,{open:y,onOpenChange:i=>{E(i),l&&l(i)},children:[e.jsx(fe,{asChild:!0,children:e.jsxs(x,{className:"gap-2 h-10 bg-gray-900 hover:bg-gray-800",children:[e.jsx(O,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:"Upload Invoices"})]})}),e.jsxs(ye,{className:"sm:max-w-[600px]",children:[e.jsxs(Ne,{children:[e.jsx(we,{children:"Upload & Extract Invoice"}),e.jsx(ke,{children:"Upload an invoice PDF or image and let AI extract the data automatically"})]}),e.jsxs("div",{className:"space-y-4",children:[!r&&!w&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{onDrop:I,onDragOver:P,onClick:()=>D.current?.click(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-all ${p?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-purple-400 hover:bg-gray-50"}`,children:[e.jsx("input",{ref:D,type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:h,className:"hidden"}),e.jsx(O,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),p?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"text-gray-900",children:p.name})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Drag & drop your invoice here"}),e.jsx("p",{className:"text-sm text-gray-400",children:"or click to browse"}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"PDF, PNG, JPG (max 10MB)"})]})]}),S&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2",children:[e.jsx(Se,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600",children:S})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(x,{variant:"outline",onClick:F,children:"Cancel"}),e.jsx(x,{onClick:_,disabled:!p,className:"bg-gray-900 hover:bg-gray-800",children:"Extract Data"})]})]}),w&&e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(de,{className:"w-12 h-12 mx-auto mb-4 text-purple-600 animate-spin"}),e.jsx("p",{className:"text-gray-600",children:"Extracting invoice data with AI..."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"This may take a few seconds"})]}),r&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-4",children:[e.jsx(oe,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Invoice data extracted successfully!"})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Supplier"}),e.jsx("p",{className:"text-sm text-gray-900",children:r.supplier_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Invoice Number"}),e.jsx("p",{className:"text-sm text-gray-900",children:r.invoice_number})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Invoice Date"}),e.jsx("p",{className:"text-sm text-gray-900",children:r.invoice_date})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Due Date"}),e.jsx("p",{className:"text-sm text-gray-900",children:r.due_date})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Net Amount"}),e.jsx("p",{className:"text-sm text-gray-900",children:r.net_amount})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"VAT"}),e.jsx("p",{className:"text-sm text-gray-900",children:r.vat_amount})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Total"}),e.jsxs("p",{className:"text-sm text-gray-900 font-semibold",children:[r.total_amount," ",r.currency]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(x,{variant:"outline",onClick:C,children:"Upload Another"}),e.jsx(x,{onClick:$,className:"bg-green-600 hover:bg-green-700",children:"Save Invoice"})]})]})]})]})]})}function Xe({companyId:f}){const{theme:s}=pe(),[l,y]=o.useState([]),[E,p]=o.useState([]),[u,w]=o.useState(""),[R,r]=o.useState(!0),[k,S]=o.useState(null),[b,D]=o.useState(new Set),[h,I]=o.useState(new Set),[P,_]=o.useState(null),[$,C]=o.useState(!1);o.useEffect(()=>{F()},[]),o.useEffect(()=>{u&&i()},[u]),o.useEffect(()=>{const t=()=>{F()};return window.addEventListener("focus",t),()=>window.removeEventListener("focus",t)},[]);const F=async()=>{try{const t=await je.getAll();p(t),f?w(f):t.length>0&&w(t[0].id)}catch(t){console.error("Failed to load companies:",t),S(t instanceof Error?t.message:"Failed to load companies"),r(!1)}},i=async()=>{if(!u){r(!1);return}try{r(!0),S(null);const t=await U.getByCompany(u);y(t)}catch(t){console.error("Failed to load invoices:",t),S(t instanceof Error?t.message:"Failed to load invoices")}finally{r(!1)}};if(R)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:s==="premium-dark"?"w-12 h-12 border-4 border-purple-500/30 border-t-purple-500 rounded-full animate-spin mx-auto mb-4":"w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:s==="premium-dark"?"text-gray-400":"text-gray-600",children:"Loading invoices..."})]})});if(k)return e.jsxs("div",{className:s==="premium-dark"?"p-6 bg-red-900/20 border border-red-500/30 rounded-lg":"p-6 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("p",{className:s==="premium-dark"?"text-red-400":"text-red-600",children:["Error: ",k]}),e.jsx(x,{onClick:i,variant:"outline",className:"mt-4",children:"Retry"})]});const c=t=>{if(!confirm(`Are you sure you want to delete invoice from ${t.vendor}?`))return;const d=l;y(l.filter(a=>a.id!==t.id)),U.delete(t.companyId,t.id).then(()=>{n.success("Invoice deleted successfully")}).catch(a=>{console.error("Failed to delete invoice:",a),y(d),n.error("Failed to delete invoice")})},g=t=>{if(!t){n.error("No document file available for this invoice");return}window.open(t,"_blank")},N=t=>{L(t,{status:"Approved"})},T=t=>{L(t,{status:"Rejected"})},L=(t,d)=>{const a=l.find(j=>j.id===t);if(!a)return;const B=l;y(l.map(j=>j.id===t?{...j,...d}:j)),_(null),U.update(a.companyId,t,d).catch(j=>{console.error("Failed to update invoice:",j),y(B),n.error("Failed to update invoice")})},Z=t=>{D(d=>{const a=new Set(d);return a.has(t)?a.delete(t):a.add(t),a})},ee=t=>{I(d=>{const a=new Set(d);return a.has(t)?a.delete(t):a.add(t),a})},te=()=>{h.size===l.length?I(new Set):I(new Set(l.map(t=>t.id)))},se=()=>{if(h.size===0){n.error("Please select at least one invoice");return}const t=l.filter(m=>h.has(m.id)),d=["Document","Vendor","Invoice #","Date","Due Date","Net","VAT","Gross","Currency","Category","Status"],a=t.map(m=>[m.documentName,m.vendor,m.invoiceNumber||"",m.date,m.dueDate||"",m.net||"",m.vat||"",m.gross,m.currency||"EUR",m.category,m.status]),B=[d.join(","),...a.map(m=>m.map(ce=>`"${ce}"`).join(","))].join(`
`),j=new Blob([B],{type:"text/csv;charset=utf-8;"}),V=document.createElement("a");V.href=URL.createObjectURL(j),V.download=`invoices_export_${new Date().toISOString().split("T")[0]}.csv`,V.click(),n.success(`Exported ${t.length} invoices to CSV`)},re=()=>{if(h.size===0){n.error("Please select at least one invoice");return}n.info("XLSX export coming soon!")},ae=t=>{switch(t){case"Pending":return e.jsx(z,{variant:"secondary",className:s==="premium-dark"?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-yellow-100 text-yellow-800",children:"ðŸ“‹ To Review"});case"Reviewed":return e.jsx(z,{variant:"secondary",className:s==="premium-dark"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-blue-100 text-blue-800",children:"âœ… Reviewed"});case"Approved":return e.jsx(z,{variant:"secondary",className:s==="premium-dark"?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-green-100 text-green-800",children:"ðŸ’° Approved"});case"Rejected":return e.jsx(z,{variant:"secondary",className:s==="premium-dark"?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-red-100 text-red-800",children:"âŒ Rejected"});default:return e.jsx(z,{variant:"secondary",children:t})}},A=(t,d="EUR")=>{const a=typeof t=="string"?parseFloat(t):t;return new Intl.NumberFormat("de-DE",{style:"currency",currency:d}).format(a)},M=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),ie=l.reduce((t,d)=>{const a=typeof d.gross=="string"?parseFloat(d.gross):d.gross;return t+(isNaN(a)?0:a)},0),le=l.filter(t=>t.status==="Pending").length,ne=l.filter(t=>t.status==="Approved"||t.status==="Reviewed").length;return e.jsxs("div",{className:"space-y-10 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:s==="premium-dark"?"text-4xl tracking-tight text-white":"text-4xl tracking-tight text-gray-900",children:"Invoice Extraction"}),e.jsx("p",{className:s==="premium-dark"?"text-purple-300/40 text-sm mt-2":"text-gray-400 text-sm mt-2",children:"Extract and process invoice data with AI"})]}),e.jsxs(x,{onClick:()=>C(!0),className:s==="premium-dark"?"gap-2 bg-white text-black hover:bg-white/90 h-10 px-6 rounded-full":"gap-2 h-10 px-6 rounded-full",children:[e.jsx(O,{className:"size-4"}),"Upload Invoice"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:s==="premium-dark"?"bg-white/[0.03] rounded-2xl p-6 border border-white/5":"bg-gray-50/50 rounded-2xl p-6",children:[e.jsx("div",{className:s==="premium-dark"?"text-purple-300/40 text-xs mb-2":"text-gray-400 text-xs mb-2",children:"Total Invoices"}),e.jsx("div",{className:s==="premium-dark"?"text-3xl text-white tracking-tight":"text-3xl text-gray-900 tracking-tight",children:l.length})]}),e.jsxs("div",{className:s==="premium-dark"?"bg-white/[0.03] rounded-2xl p-6 border border-white/5":"bg-gray-50/50 rounded-2xl p-6",children:[e.jsx("div",{className:s==="premium-dark"?"text-purple-300/40 text-xs mb-2":"text-gray-400 text-xs mb-2",children:"Pending Review"}),e.jsx("div",{className:"text-3xl text-yellow-500 tracking-tight",children:le})]}),e.jsxs("div",{className:s==="premium-dark"?"bg-white/[0.03] rounded-2xl p-6 border border-white/5":"bg-gray-50/50 rounded-2xl p-6",children:[e.jsx("div",{className:s==="premium-dark"?"text-purple-300/40 text-xs mb-2":"text-gray-400 text-xs mb-2",children:"Approved"}),e.jsx("div",{className:"text-3xl text-green-500 tracking-tight",children:ne})]}),e.jsxs("div",{className:s==="premium-dark"?"bg-white/[0.03] rounded-2xl p-6 border border-white/5":"bg-gray-50/50 rounded-2xl p-6",children:[e.jsx("div",{className:s==="premium-dark"?"text-purple-300/40 text-xs mb-2":"text-gray-400 text-xs mb-2",children:"Total Amount"}),e.jsx("div",{className:s==="premium-dark"?"text-3xl text-white tracking-tight":"text-3xl text-gray-900 tracking-tight",children:A(ie)})]})]}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsxs(X,{value:u,onValueChange:w,children:[e.jsxs(H,{className:s==="premium-dark"?"bg-white/[0.03] border-white/10 text-white hover:bg-white/[0.05] h-11 rounded-xl flex-1":"bg-gray-50/50 border-gray-200 h-11 rounded-xl flex-1",children:[e.jsx(Ie,{className:"size-4 mr-2"}),e.jsx(J,{placeholder:"Select company"})]}),e.jsx(K,{className:s==="premium-dark"?"bg-gray-900 border-white/10":"",children:E.map(t=>e.jsx(v,{value:t.id,className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:t.name},t.id))})]}),e.jsx(x,{variant:"outline",size:"icon",onClick:()=>{F(),n.success("Companies refreshed")},className:s==="premium-dark"?"bg-white/[0.03] border-white/10 text-gray-300 hover:bg-white/[0.05] hover:text-white h-11 w-11 rounded-xl":"bg-gray-50/50 border-gray-200 h-11 w-11 rounded-xl",title:"Refresh companies",children:e.jsx(ue,{className:"size-4"})})]}),e.jsxs(De,{children:[e.jsx(Ce,{asChild:!0,children:e.jsxs(x,{variant:"outline",disabled:h.size===0,className:s==="premium-dark"?"bg-white/[0.03] border-white/10 text-gray-300 hover:bg-white/[0.05] hover:text-white h-11 rounded-xl":"bg-gray-50/50 border-gray-200 h-11 rounded-xl",children:[e.jsx(he,{className:"size-4 mr-2"}),"Export Selected (",h.size,")",e.jsx(W,{className:"size-4 ml-2"})]})}),e.jsxs(Ee,{align:"end",className:s==="premium-dark"?"bg-gray-900 border-white/10":"",children:[e.jsx(Y,{onClick:se,className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:"Export as CSV"}),e.jsx(Y,{onClick:re,className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:"Export as XLSX"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:s==="premium-dark"?"text-lg text-white/80 tracking-tight":"text-lg text-gray-700 tracking-tight",children:"Invoices"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{checked:h.size===l.length&&l.length>0,onCheckedChange:te,className:s==="premium-dark"?"border-white/20 data-[state=checked]:bg-white data-[state=checked]:text-black data-[state=checked]:border-white":""}),e.jsx("span",{className:s==="premium-dark"?"text-sm text-purple-300/40":"text-sm text-gray-400",children:"Select All"})]})]}),l.length===0?e.jsxs("div",{className:s==="premium-dark"?"text-center py-20 border-2 border-dashed border-white/5 rounded-2xl":"text-center py-20 border-2 border-dashed border-gray-200 rounded-2xl",children:[e.jsx(G,{className:s==="premium-dark"?"size-12 mx-auto mb-4 text-white/10":"size-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:s==="premium-dark"?"text-white/60":"text-gray-500",children:"No invoices found"}),e.jsx("p",{className:s==="premium-dark"?"text-sm mt-2 text-purple-300/40":"text-sm mt-2 text-gray-400",children:"Upload invoices to get started"})]}):e.jsx("div",{className:"space-y-3",children:l.map(t=>e.jsx("div",{className:s==="premium-dark"?"bg-white/[0.03] border border-white/5 rounded-xl p-5 hover:bg-white/[0.05] transition-all":"bg-white border border-gray-100 rounded-xl p-5 hover:border-gray-200 hover:shadow-sm transition-all",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(q,{checked:h.has(t.id),onCheckedChange:()=>ee(t.id),className:s==="premium-dark"?"mt-1 border-white/20 data-[state=checked]:bg-white data-[state=checked]:text-black data-[state=checked]:border-white":"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0",children:[e.jsx(G,{className:s==="premium-dark"?"size-5 text-white/20 flex-shrink-0 mt-0.5":"size-5 text-gray-300 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:s==="premium-dark"?"text-sm text-white mb-1":"text-sm text-gray-900 mb-1",children:t.vendor}),e.jsxs("p",{className:s==="premium-dark"?"text-xs text-purple-300/40 truncate":"text-xs text-gray-400 truncate",children:[t.documentName,t.source==="email"&&e.jsxs("span",{className:s==="premium-dark"?"ml-2 text-purple-400":"ml-2 text-blue-500",children:[e.jsx(ge,{className:"size-3 inline-block"})," Via email"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[ae(t.status),e.jsx("span",{className:s==="premium-dark"?"text-base text-white tracking-tight":"text-base text-gray-900 tracking-tight",children:A(t.gross,t.currency||"EUR")})]})]}),e.jsxs("div",{className:s==="premium-dark"?"flex items-center gap-6 text-xs text-purple-300/40 mb-4":"flex items-center gap-6 text-xs text-gray-400 mb-4",children:[e.jsx("span",{children:M(t.date)}),e.jsxs("span",{children:["#",t.invoiceNumber||"No invoice #"]}),P===t.id?e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(X,{value:t.category,onValueChange:d=>L(t.id,{category:d}),children:[e.jsx(H,{className:s==="premium-dark"?"h-6 text-xs w-auto min-w-[140px] bg-white/[0.03] border-white/10 text-white":"h-6 text-xs w-auto min-w-[140px]",children:e.jsx(J,{})}),e.jsxs(K,{className:s==="premium-dark"?"bg-gray-900 border-white/10":"",children:[e.jsx(v,{value:"Services",className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:"Services"}),e.jsx(v,{value:"General Expense",className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:"General Expense"}),e.jsx(v,{value:"Office Supplies",className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:"Office Supplies"}),e.jsx(v,{value:"Software & Subscriptions",className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:"Software & Subscriptions"}),e.jsx(v,{value:"Travel & Transportation",className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:"Travel & Transportation"}),e.jsx(v,{value:"Utilities",className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:"Utilities"}),e.jsx(v,{value:"Professional Services",className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:"Professional Services"}),e.jsx(v,{value:"Other",className:s==="premium-dark"?"text-gray-300 hover:bg-purple-500/10 focus:bg-purple-500/10 focus:text-white":"",children:"Other"})]})]})}):e.jsx("span",{className:s==="premium-dark"?"cursor-pointer hover:text-white transition-colors":"cursor-pointer hover:text-gray-900 transition-colors",onClick:()=>_(t.id),children:t.category})]}),b.has(t.id)&&e.jsxs("div",{className:s==="premium-dark"?"mb-4 pt-4 border-t border-white/5 space-y-3":"mb-4 pt-4 border-t border-gray-100 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[t.net&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s==="premium-dark"?"text-purple-300/40":"text-gray-400",children:"Net Amount"}),e.jsx("span",{className:s==="premium-dark"?"text-white":"text-gray-900",children:A(t.net,t.currency||"EUR")})]}),t.vat&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s==="premium-dark"?"text-purple-300/40":"text-gray-400",children:"VAT"}),e.jsx("span",{className:s==="premium-dark"?"text-white":"text-gray-900",children:A(t.vat,t.currency||"EUR")})]}),t.dueDate&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s==="premium-dark"?"text-purple-300/40":"text-gray-400",children:"Due Date"}),e.jsx("span",{className:s==="premium-dark"?"text-white":"text-gray-900",children:M(t.dueDate)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s==="premium-dark"?"text-purple-300/40":"text-gray-400",children:"Gross Total"}),e.jsx("span",{className:s==="premium-dark"?"text-white":"text-gray-900",children:A(t.gross,t.currency||"EUR")})]})]}),t.source==="email"&&t.emailFrom&&e.jsxs("div",{className:s==="premium-dark"?"pt-3 border-t border-white/5":"pt-3 border-t border-gray-100",children:[e.jsx("div",{className:s==="premium-dark"?"text-xs text-purple-300/40 mb-2":"text-xs text-gray-400 mb-2",children:"Email Details"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:s==="premium-dark"?"text-purple-300/40 w-20":"text-gray-400 w-20",children:"From"}),e.jsx("span",{className:s==="premium-dark"?"text-white":"text-gray-900",children:t.emailFrom})]}),t.emailSubject&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:s==="premium-dark"?"text-purple-300/40 w-20":"text-gray-400 w-20",children:"Subject"}),e.jsx("span",{className:s==="premium-dark"?"text-white":"text-gray-900",children:t.emailSubject})]}),t.emailReceivedAt&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:s==="premium-dark"?"text-purple-300/40 w-20":"text-gray-400 w-20",children:"Received"}),e.jsx("span",{className:s==="premium-dark"?"text-white":"text-gray-900",children:new Date(t.emailReceivedAt).toLocaleString()})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>Z(t.id),className:s==="premium-dark"?"text-purple-300/60 hover:text-white hover:bg-white/[0.05] h-8":"h-8",children:[e.jsx(W,{className:`size-4 transition-transform ${b.has(t.id)?"rotate-180":""}`}),b.has(t.id)?"Hide":"Show"," Details"]}),t.status==="Pending"&&e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>N(t.id),className:"text-green-500 hover:text-green-600 hover:bg-green-500/10 h-8",children:"Approve"}),e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>T(t.id),className:"text-red-500 hover:text-red-600 hover:bg-red-500/10 h-8",children:"Reject"})]}),t.fileUrl&&e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>g(t.fileUrl),className:s==="premium-dark"?"text-purple-300/60 hover:text-white hover:bg-white/[0.05] h-8":"h-8",children:[e.jsx(Fe,{className:"size-4 mr-1"}),"View"]}),e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>c(t),className:s==="premium-dark"?"text-gray-500 hover:text-red-400 hover:bg-red-500/10":"text-red-600 hover:text-red-700",children:[e.jsx(Te,{className:"size-4 mr-1"}),"Delete"]})]})]})]})},t.id))})]}),$&&u&&e.jsx(Ae,{companyId:u,onSuccess:()=>{i(),C(!1)},onOpenChange:C})]})}export{Xe as InvoiceExtraction};
