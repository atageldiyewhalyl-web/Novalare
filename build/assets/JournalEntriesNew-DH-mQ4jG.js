import{c as yt,E as bt,r as c,p,b as u,j as e,a as m,P as Je,a3 as $,X as ft,D as ue,a7 as O,a1 as w,k as ge,d as re,t as d}from"./index-DrBwAU1T.js";import{C as R,b as X,c as Q,a as _}from"./card-Cmu1fk5m.js";import{c as vt}from"./api-client-BUzUkZPR.js";import{D as ae,a as ne,g as ie,b as oe,c as g}from"./DevPortal--LMNXygJ.js";import{T as Nt,a as wt,b as je,c as ye}from"./tabs-B1Vb_bsc.js";import{B as q}from"./badge-BVkw5bJj.js";import{B as kt}from"./book-open-BQfJsvX3.js";import{T as Ct}from"./trash-2-CxXCVqKn.js";import{P as Me}from"./plus-B8Ewa_Kr.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Ue=yt("square-pen",St);function Jt({companyId:be,companyName:Et,onNavigate:fe}){const{theme:i}=bt(),[ve,Ve]=c.useState([]),[n,ce]=c.useState(null),[o,Ne]=c.useState(""),[$t,Ge]=c.useState([]),[f,Xe]=c.useState([]),[x,C]=c.useState(null),[H,we]=c.useState(""),[le,ke]=c.useState(!1),[K,de]=c.useState({}),[At,Ce]=c.useState(!1),[S,D]=c.useState([]),[Qe,Se]=c.useState(!1),[W,Y]=c.useState({}),[Z,Ee]=c.useState(!1),[$e,xe]=c.useState(null),[k,z]=c.useState(null),[me,ee]=c.useState(""),[he,te]=c.useState(""),[Ae,J]=c.useState(!1),[Te,M]=c.useState(!1),[N,U]=c.useState([]),[qe,De]=c.useState(!1),[E,pe]=c.useState([]),[He,ze]=c.useState(!1),[V,Ke]=c.useState("draft"),[Tt,We]=c.useState([]),j=t=>{const s=new Date().toLocaleTimeString();We(r=>[...r,`[${s}] ${t}`]),console.log(t)};c.useEffect(()=>{Ye();const t=new Date,s=t.getFullYear(),r=(t.getMonth()+1).toString().padStart(2,"0");Ne(`${s}-${r}`)},[]);const Fe=(()=>{const t=[],s=new Date;for(let r=0;r<12;r++){const a=new Date(s.getFullYear(),s.getMonth()-r,1),l=a.getFullYear(),b=(a.getMonth()+1).toString().padStart(2,"0"),A=`${l}-${b}`,B=a.toLocaleDateString("en-US",{month:"long",year:"numeric"});t.push({value:A,label:B})}return t})(),Ye=async()=>{try{const t=await vt.getAll();if(Ve(t||[]),be){const s=t.find(r=>r.id===be);s&&ce(s)}else t.length>0&&ce(t[0])}catch(t){console.error("Failed to load companies:",t)}};c.useEffect(()=>{n&&(Ze(),Be())},[n]),c.useEffect(()=>{n&&o&&(se(),G())},[n,o]),c.useEffect(()=>{V==="ready"&&n&&o&&(console.log("ðŸ“‘ Switching to Ready tab - reloading entries..."),G())},[V]),c.useEffect(()=>{V==="posted"&&n&&o&&(console.log("ðŸ“‘ Switching to Posted tab - loading entries..."),Ie())},[V]);const Ze=async()=>{if(n)try{const t=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/companies/${n.id}/coa`,{headers:{Authorization:`Bearer ${u}`}});if(t.ok){const s=await t.json();Xe(s.accounts||[])}}catch(t){console.error("Failed to load chart of accounts for company:",n.id,t)}},Be=async()=>{if(n){Ce(!0);try{const t=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/companies/${n.id}/journal-entries`,{headers:{Authorization:`Bearer ${u}`}});if(t.ok){const s=await t.json();Ge(s.entries||[])}}catch(t){console.error("Failed to load journal entry history for company:",n.id,t)}finally{Ce(!1)}}},se=async()=>{if(!(!n||!o)){Se(!0);try{const t=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/suggestions?companyId=${n.id}&period=${o}`,{headers:{Authorization:`Bearer ${u}`}});if(t.ok){const s=await t.json();console.log("Loaded suggested entries:",s),D(s.suggestions||[])}else console.error("Failed to load suggested entries:",t.status),D([])}catch(t){console.error("Failed to load suggested entries:",t),D([])}finally{Se(!1)}}},G=async()=>{if(!(!n||!o)){De(!0);try{const t=`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries?companyId=${n.id}&period=${o}`,s=await fetch(t,{headers:{Authorization:`Bearer ${u}`}});if(s.ok){const r=await s.json();U(r.ready||[])}else console.error("Failed to load ready entries:",s.status),U([])}catch(t){console.error("Failed to load ready entries:",t),U([])}finally{De(!1)}}},Ie=async()=>{if(!(!n||!o)){ze(!0);try{const t=`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries?companyId=${n.id}&period=${o}`,s=await fetch(t,{headers:{Authorization:`Bearer ${u}`}});if(s.ok){const r=await s.json();pe(r.posted||[])}else console.error("Failed to load posted entries:",s.status),pe([])}catch(t){console.error("Failed to load posted entries:",t),pe([])}finally{ze(!1)}}},Le=async()=>{if(H.trim()){ke(!0);try{const t=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/generate`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({prompt:H,chartOfAccounts:f})});if(!t.ok)throw new Error("Failed to generate journal entry");const s=await t.json(),r={id:`je_draft_${Date.now()}`,date:new Date().toISOString().split("T")[0],description:s.description,lines:s.lines.map((a,l)=>({account:a.accountName,accountCode:a.account,debit:a.debit||0,credit:a.credit||0})),totalDebit:0,totalCredit:0,isBalanced:!1,createdAt:Date.now().toString(),createdBy:"AI"};C(r),we("")}catch(t){console.error("AI generation error:",t),alert("Failed to generate journal entry. Please try again.")}finally{ke(!1)}}},Pe=()=>{if(x)C({...x,lines:[...x.lines,{account:"",accountCode:"",debit:"0.00",credit:"0.00"}]});else{const t={id:`je_draft_${Date.now()}`,date:new Date().toISOString().split("T")[0],description:"",lines:[{account:"",accountCode:"",debit:"0.00",credit:"0.00"}],totalDebit:0,totalCredit:0,isBalanced:!1,createdAt:Date.now().toString(),createdBy:"User"};C(t)}},et=t=>{x&&C({...x,lines:x.lines.filter((s,r)=>r!==t)})},I=(t,s,r)=>{x&&C({...x,lines:x.lines.map((a,l)=>l===t?{...a,[s]:r}:a)})},tt=(t,s)=>{const r=f.find(a=>a.code===s);r&&(I(t,"account",r.name),I(t,"accountCode",s),de(a=>({...a,[t]:""})))},Oe=()=>{if(!x)return{debit:0,credit:0,balanced:!0};const t=x.lines.reduce((r,a)=>r+parseFloat(a.debit||"0"),0),s=x.lines.reduce((r,a)=>r+parseFloat(a.credit||"0"),0);return{debit:t,credit:s,balanced:Math.abs(t-s)<.01}},st=async()=>{if(!x)return;if(!Oe().balanced){alert("Entry is not balanced! Debits must equal Credits.");return}if(!x.description.trim()){alert("Please add a description for this journal entry.");return}if(x.lines.some(s=>!s.accountCode)){alert("All lines must have an account selected.");return}try{const s={...x,status:"posted",id:`je_${Date.now()}`,createdAt:Date.now()};if(!(await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/companies/${n?.id}/journal-entries`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw new Error("Failed to post journal entry");C(null),Be(),alert("Journal entry posted successfully!")}catch(s){console.error("Failed to post entry:",s),alert("Failed to post journal entry. Please try again.")}},rt=()=>{C(null),de({})},at=async()=>{try{const t=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/export`,{headers:{Authorization:`Bearer ${u}`}});if(!t.ok){const l=await t.json();throw console.error("Export error details:",l),new Error(l.details||"Export failed")}const s=await t.blob(),r=window.URL.createObjectURL(s),a=document.createElement("a");a.href=r,a.download=`Journal_Entries_${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(r),document.body.removeChild(a)}catch(t){console.error("Export error:",t),alert("Failed to export journal entries: "+t.message)}},y=t=>`â‚¬${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,nt=t=>t.debit!==void 0&&t.debit!==null?t.debit||0:t.credit!==void 0&&t.credit!==null?-(t.credit||0):t.amount||0,Re=async()=>{if(!(!n||!o||S.length===0)){Ee(!0);try{const t=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/bulk-generate`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({companyId:n.id,period:o,transactions:S,chartOfAccounts:f})});if(t.ok){const s=await t.json();console.log("Bulk JE generation result:",s),D(s.updatedSuggestions||[]),d.success(`Generated ${s.updatedSuggestions?.length||0} journal entry suggestions`)}else{const s=await t.text();console.error("Failed to generate JEs:",t.status,s),d.error("Failed to generate journal entries. Please try again.")}}catch(t){console.error("Error generating JEs:",t),d.error("Network error. Please check your connection and try again.")}finally{Ee(!1)}}},_e=t=>{xe(t.id);const s=t.sourceItem.suggested_je;if(s)z({debit_account:s.debit_account,credit_account:s.credit_account,amount:s.amount,memo:s.memo||""});else{const a=t.sourceType==="bank"?t.sourceItem.transaction:t.sourceItem.entry;z({debit_account:"",credit_account:"",amount:Math.abs(a.amount),memo:a.description||""})}ee(""),te(""),J(!1),M(!1)},it=()=>{xe(null),z(null),ee(""),te(""),J(!1),M(!1)},ot=async t=>{if(!n||!o||!k)return;const s=`save-${t}`;Y(r=>({...r,[s]:!0}));try{const r=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/update-suggestion`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({companyId:n.id,period:o,suggestionId:t,updatedJE:k})});if(r.ok){const a=await r.json();D(l=>l.map(b=>b.id===t?{...b,sourceItem:{...b.sourceItem,suggested_je:k}}:b)),d.success("Journal entry updated successfully"),xe(null),z(null)}else{const a=await r.text();console.error("Failed to update suggestion:",r.status,a),d.error("Failed to update journal entry. Please try again.")}}catch(r){console.error("Error updating suggestion:",r),d.error("Network error. Please check your connection and try again.")}finally{Y(r=>({...r,[s]:!1}))}},ct=t=>{z(s=>({...s,debit_account:t})),J(!1),ee("")},lt=t=>{z(s=>({...s,credit_account:t})),M(!1),te("")},dt=()=>{if(!me)return f;const t=me.toLowerCase();return f.filter(s=>s.code.toLowerCase().includes(t)||s.name.toLowerCase().includes(t))},xt=()=>{if(!he)return f;const t=he.toLowerCase();return f.filter(s=>s.code.toLowerCase().includes(t)||s.name.toLowerCase().includes(t))},mt=async t=>{if(!n||!o)return;j(`ðŸš€ Approving JE: ${t}`);const s=`approve-${t}`;Y(r=>({...r,[s]:!0})),D(r=>r.filter(a=>a.id!==t));try{j("ðŸ“¡ Calling /journal-entries/approve"),j(`ðŸ“‹ POST params: companyId=${n.id}, period=${o}`);const r=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/approve`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({companyId:n.id,period:o,suggestionId:t})});if(j(`ðŸ“¥ Approve response: ${r.status}`),r.ok){const a=await r.json();j(`âœ… Approve success: ${JSON.stringify(a)}`),a.debug&&(j(`ðŸ” Backend Debug: Key=${a.debug.key}`),j(`ðŸ” Count Before=${a.debug.countBefore}, After=${a.debug.countAfter}`),j(`ðŸ” Verify Count=${a.debug.verifyCount}`),j(`ðŸ” Saved Successfully=${a.debug.savedSuccessfully}`)),console.log("âœ… Approve response:",a),d.success("Journal entry approved and moved to Ready to Export"),j("â³ Waiting 100ms for KV store consistency..."),await new Promise(l=>setTimeout(l,100)),j("ðŸ”„ Now reloading ready entries..."),await G()}else{const a=await r.text();j(`âŒ Approve failed: ${r.status} - ${a}`),console.error("âŒ Failed to approve JE:",r.status,a),d.error("Failed to approve journal entry. Please try again."),await se()}}catch(r){j(`âŒ Error approving: ${r}`),console.error("Error approving JE:",r),d.error("Network error. Please check your connection and try again."),await se()}finally{Y(r=>({...r,[s]:!1}))}},L=async t=>{if(!n||!o||N.length===0){d.error("No entries to export");return}try{console.log(`ðŸ“¥ Exporting ${N.length} entries as ${t}`);const s=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/export`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({companyId:n.id,period:o,format:t,entries:N})});if(s.ok){const r=await s.blob(),a=window.URL.createObjectURL(r),l=document.createElement("a");l.href=a;const A={csv:"csv",excel:"xlsx","qb-csv":"csv",iif:"iif","xero-csv":"csv","datev-csv":"csv"}[t]||"csv",v={csv:"CSV",excel:"Excel","qb-csv":"QuickBooks",iif:"IIF","xero-csv":"Xero","datev-csv":"DATEV"}[t]||t;l.download=`JournalEntries_${n.name}_${o}_${v}.${A}`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(a),document.body.removeChild(l),d.success(`Exported ${N.length} entries as ${v}`),await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/track-export`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({companyId:n.id,period:o,format:t,entryIds:N.map(T=>T.id)})}),await G()}else{const r=await s.text();console.error("Export failed:",r),d.error("Failed to export entries")}}catch(s){console.error("Export error:",s),d.error("Network error during export")}},ht=async()=>{if(!n||!o||N.length===0){d.error("No entries to mark as posted");return}try{const t=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/mark-posted`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({companyId:n.id,period:o})});if(t.ok)d.success(`Marked ${N.length} entries as posted in QB/Xero/DATEV`),U([]);else{const s=await t.text();console.error("Mark as posted failed:",s),d.error("Failed to mark entries as posted")}}catch(t){console.error("Mark as posted error:",t),d.error("Network error")}},P=async t=>{if(!n||!o||E.length===0){d.error("No entries to re-export");return}try{console.log(`ðŸ“¥ Re-exporting ${E.length} posted entries as ${t}`);const s=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/export`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({companyId:n.id,period:o,format:t,entries:E})});if(s.ok){const r=await s.blob(),a=window.URL.createObjectURL(r),l=document.createElement("a");l.href=a;const A={csv:"csv",excel:"xlsx","qb-csv":"csv",iif:"iif","xero-csv":"csv","datev-csv":"csv"}[t]||"csv",v={csv:"CSV",excel:"Excel","qb-csv":"QuickBooks",iif:"IIF","xero-csv":"Xero","datev-csv":"DATEV"}[t]||t;l.download=`JournalEntries_Posted_${n.name}_${o}_${v}.${A}`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(a),document.body.removeChild(l),d.success(`Re-exported ${E.length} posted entries as ${v}`),await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/track-export`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({companyId:n.id,period:o,format:t,entryIds:E.map(T=>T.id)})}),await Ie()}else{const r=await s.text();console.error("Re-export failed:",r),d.error("Failed to re-export entries")}}catch(s){console.error("Re-export error:",s),d.error("Network error during re-export")}},pt=async t=>{if(!n||!o){d.error("Please select a company and period");return}try{console.log(`ðŸ“ Moving entry ${t.id} back to draft for editing`);const s=await fetch(`https://${p}.supabase.co/functions/v1/make-server-53c2e113/journal-entries/move-to-draft`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({companyId:n.id,period:o,entryId:t.id})});if(s.ok)d.success("Entry moved back to draft - you can now edit it"),U(r=>r.filter(a=>a.id!==t.id)),D(r=>[...r,{...t,status:"suggested"}]),await Promise.all([se(),G()]);else{const r=await s.text();console.error("Move to draft failed:",r),d.error("Failed to move entry back to draft")}}catch(s){console.error("Move to draft error:",s),d.error("Network error while moving entry")}},F=Oe(),ut=t=>{const s=K[t]||"";if(!s)return f;const r=s.toLowerCase();return f.filter(a=>a.code.includes(r)||a.name.toLowerCase().includes(r))};return e.jsxs("div",{className:"space-y-6 pb-64",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:i==="premium-dark"?"text-3xl text-white":"text-3xl text-gray-900",children:"Journal Entries"}),e.jsx("p",{className:i==="premium-dark"?"text-white/60 mt-1":"text-gray-500 mt-1",children:"Create and manage journal entries with AI assistance"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(ae,{children:[e.jsx(ne,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:"gap-2 h-10 min-w-[200px]",children:[e.jsx(Je,{className:"size-4 text-purple-600"}),e.jsx("span",{className:"flex-1 text-left truncate",children:n?.name||"Select Company"}),e.jsx(ie,{className:"size-4 text-gray-500"})]})}),e.jsx(oe,{align:"end",className:"w-[250px]",children:ve.length===0?e.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No companies available"}):ve.map(t=>e.jsx(g,{onClick:()=>ce(t),className:`cursor-pointer ${n?.id===t.id?"bg-purple-50":""}`,children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx(Je,{className:`size-4 ${n?.id===t.id?"text-purple-600":"text-gray-400"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-900 truncate",children:t.name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.country})]}),n?.id===t.id&&e.jsx($,{className:"size-4 text-purple-600 flex-shrink-0"})]})},t.id))})]}),e.jsxs(ae,{children:[e.jsx(ne,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:"gap-2 h-10",children:[e.jsx(ft,{className:"size-4"}),Fe.find(t=>t.value===o)?.label,e.jsx(ie,{className:"size-4"})]})}),e.jsx(oe,{align:"end",children:Fe.map(t=>e.jsx(g,{onClick:()=>Ne(t.value),className:o===t.value?"bg-purple-50":"",children:t.label},t.value))})]}),n&&fe&&e.jsxs(m,{variant:"outline",className:"gap-2 h-10",onClick:()=>fe("company",{companyId:n.id,activeTab:"coa"}),children:[e.jsx(kt,{className:"size-4"}),e.jsx("span",{className:"text-sm hidden sm:inline",children:"Chart of Accounts"})]}),e.jsxs(m,{variant:"outline",className:"gap-2 h-10",onClick:at,children:[e.jsx(ue,{className:"size-4"}),e.jsx("span",{className:"text-sm hidden sm:inline",children:"Export"})]})]})]}),e.jsxs(R,{className:i==="premium-dark"?"bg-white/[0.03] border-white/10 rounded-2xl":"bg-white border-gray-100 rounded-2xl",children:[e.jsx(X,{children:e.jsxs(Q,{className:i==="premium-dark"?"flex items-center gap-2 text-white":"flex items-center gap-2",children:[e.jsx(O,{className:"size-5 text-purple-600"}),"AI Journal Entry Generator"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:i==="premium-dark"?"text-sm text-white/60 mb-2 block":"text-sm text-gray-600 mb-2 block",children:"Describe the journal entry you want to create"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(w,{value:H,onChange:t=>we(t.target.value),placeholder:"e.g., Record $5,000 rent payment for December",className:i==="premium-dark"?"flex-1 h-12 bg-white/5 border-white/10 text-white placeholder:text-white/40":"flex-1 h-12",onKeyDown:t=>{t.key==="Enter"&&!le&&Le()}}),e.jsx(m,{onClick:Le,disabled:le||!H.trim(),className:i==="premium-dark"?"h-12 px-6 bg-white text-black hover:bg-white/90 rounded-xl":"h-12 px-6 bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700 rounded-xl",children:le?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-current border-t-transparent mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"size-4 mr-2"}),"Generate Entry"]})})]})]}),e.jsxs("div",{className:i==="premium-dark"?"text-xs text-white/40 space-y-1":"text-xs text-gray-500 space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Examples:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 ml-2",children:[e.jsx("li",{children:'"Record â‚¬3,500 rent expense for January"'}),e.jsx("li",{children:'"Accrue â‚¬1,200 salary expense"'}),e.jsx("li",{children:'"Depreciate equipment by â‚¬500"'}),e.jsx("li",{children:'"Record â‚¬10,000 cash sale"'})]})]})]})]}),x&&e.jsxs(R,{children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Q,{children:"Journal Entry Editor"}),e.jsx("div",{className:"flex items-center gap-3",children:F.balanced?e.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm",children:[e.jsx($,{className:"size-4"}),e.jsx("span",{children:"Balanced"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(ge,{className:"size-4"}),e.jsx("span",{children:"Out of Balance"})]})})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block",children:"Date"}),e.jsx(w,{type:"date",value:x.date,onChange:t=>C({...x,date:t.target.value}),className:"h-10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1 block",children:"Description"}),e.jsx(w,{value:x.description,onChange:t=>C({...x,description:t.target.value}),placeholder:"Enter description",className:"h-10"})]})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 text-gray-600 text-sm w-[25%]",children:"Account"}),e.jsx("th",{className:"text-left py-3 px-4 text-gray-600 text-sm w-[20%]",children:"Debit"}),e.jsx("th",{className:"text-left py-3 px-4 text-gray-600 text-sm w-[20%]",children:"Credit"}),e.jsx("th",{className:"text-left py-3 px-4 text-gray-600 text-sm w-[25%]",children:"Memo"}),e.jsx("th",{className:"text-left py-3 px-4 text-gray-600 text-sm w-[10%]"})]})}),e.jsx("tbody",{children:x.lines.map((t,s)=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-3 px-4",children:t.accountCode?e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"text-gray-900",children:[t.accountCode," - ",t.account]}),e.jsx("button",{onClick:()=>I(s,"accountCode",""),className:"text-xs text-purple-600 hover:text-purple-700",children:"Change"})]}):e.jsxs("div",{className:"relative",children:[e.jsx(w,{value:K[s]||"",onChange:r=>de({...K,[s]:r.target.value}),placeholder:"Search account...",className:"h-9 text-sm"}),K[s]&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:ut(s).map(r=>e.jsxs("button",{onClick:()=>tt(s,r.code),className:"w-full text-left px-3 py-2 hover:bg-purple-50 text-sm border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"text-gray-900",children:[r.code," - ",r.name]}),e.jsx("div",{className:"text-xs text-gray-500",children:r.type})]},r.code))})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(w,{type:"number",step:"0.01",value:t.debit||"",onChange:r=>I(s,"debit",r.target.value),placeholder:"0.00",className:"h-9 text-sm"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(w,{type:"number",step:"0.01",value:t.credit||"",onChange:r=>I(s,"credit",r.target.value),placeholder:"0.00",className:"h-9 text-sm"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(w,{value:t.memo,onChange:r=>I(s,"memo",r.target.value),placeholder:"Optional memo",className:"h-9 text-sm"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>et(s),className:"h-8 w-8 p-0 text-gray-400 hover:text-red-600",children:e.jsx(Ct,{className:"size-4"})})})]},s))}),e.jsxs("tfoot",{className:"bg-gray-50 border-t-2 border-gray-200",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:"Totals"}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-900",children:y(F.debit)}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-900",children:y(F.credit)}),e.jsx("td",{colSpan:2})]}),e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-2 px-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:F.balanced?e.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm",children:[e.jsx($,{className:"size-4"}),e.jsx("span",{children:"Entry is balanced"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(ge,{className:"size-4"}),e.jsxs("span",{children:["Difference: ",y(Math.abs(F.debit-F.credit))]})]})})})})})]})]})}),e.jsxs("div",{className:"flex gap-3 justify-between",children:[e.jsxs(m,{variant:"outline",onClick:Pe,className:"gap-2",children:[e.jsx(Me,{className:"size-4"}),"Add Line"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{variant:"outline",onClick:rt,children:"Clear"}),e.jsx(m,{onClick:st,disabled:!F.balanced,className:"bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700",children:"Post Entry"})]})]})]})]}),!x&&e.jsx(R,{children:e.jsx(_,{className:"pt-6",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs(m,{onClick:Pe,variant:"outline",className:"gap-2 h-12",children:[e.jsx(Me,{className:"size-4"}),"Create Manual Entry"]})})})}),e.jsxs(Nt,{value:V,onValueChange:Ke,className:"w-full",children:[e.jsxs(wt,{className:"grid w-full grid-cols-3",children:[e.jsx(je,{value:"draft",children:"Draft / Suggested"}),e.jsx(je,{value:"ready",children:"Ready to Export"}),e.jsx(je,{value:"posted",children:"Posted in System"})]}),e.jsx(ye,{value:"draft",children:e.jsxs(R,{className:i==="premium-dark"?"bg-white/[0.03] border-white/10 rounded-2xl":"bg-white border-gray-100 rounded-2xl",children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Q,{className:i==="premium-dark"?"text-white":"",children:"Draft / Suggested Entries"}),e.jsx("p",{className:i==="premium-dark"?"text-sm text-white/60 mt-1":"text-sm text-gray-500 mt-1",children:"AI suggestions from month-end close, reconciliation modules, and TB anomaly detection"})]}),S.length>0&&e.jsxs(q,{variant:"outline",className:i==="premium-dark"?"bg-white/5 text-white/80 border-white/10":"bg-gray-50 text-gray-700 border-gray-200",children:[S.length," suggestion",S.length!==1?"s":""]})]})}),e.jsx(_,{children:Qe?e.jsxs("div",{className:i==="premium-dark"?"text-center py-12 text-white/60":"text-center py-12 text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-purple-600 border-t-transparent mx-auto mb-3"}),"Loading suggested entries..."]}):S.length===0?e.jsx("div",{className:i==="premium-dark"?"text-center py-12 text-white/60":"text-center py-12 text-gray-500",children:"No draft or suggested entries at this time."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:i==="premium-dark"?"border border-white/10 rounded-lg p-4 bg-white/[0.02]":"border border-gray-200 rounded-lg p-4 bg-gray-50/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(O,{className:"size-5 text-purple-600"}),e.jsx("h3",{className:i==="premium-dark"?"font-medium text-white":"font-medium text-gray-900",children:"AI Journal Entry Generator"})]}),e.jsxs("p",{className:i==="premium-dark"?"text-sm text-white/60":"text-sm text-gray-600",children:["Generate detailed journal entry suggestions for all ",S.length," transaction",S.length!==1?"s":""," using AI"]})]}),e.jsx(m,{onClick:Re,disabled:Z||f.length===0,className:i==="premium-dark"?"gap-2 bg-white text-black hover:bg-white/90 rounded-xl ml-4":"gap-2 bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700 rounded-xl ml-4",children:Z?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"size-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"size-4"}),"Generate JE Suggestions for All"]})})]}),f.length===0&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-orange-600 text-sm",children:[e.jsx(ge,{className:"size-4"}),e.jsx("span",{children:"Chart of Accounts required for AI generation"})]})]}),S.map(t=>{const s=t.sourceItem,r=t.sourceType==="bank",a=t.sourceType==="cc",l=t.sourceType==="ledger-reversal",b=t.sourceType==="vendor",A=t.sourceType==="ap",B=r||a||b?s.transaction:s.entry,v=l||!r&&!a&&!b?{...B,amount:nt(B)}:B,T=s.suggested_je!=null,gt=b||A;return v?e.jsxs("div",{className:i==="premium-dark"?"border border-white/10 rounded-lg p-4 bg-white/[0.02]":"border border-gray-200 rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:i==="premium-dark"?"text-xs text-white/40":"text-xs text-gray-500",children:v.date}),e.jsx("span",{className:i==="premium-dark"?"text-xs text-white/20":"text-xs text-gray-300",children:"â€¢"}),e.jsx("span",{className:i==="premium-dark"?"text-xs text-white/40":"text-xs text-gray-500",children:l?"Ledger Reversal":r?"Bank Rec":a?"CC Rec":b?"AP Rec (Vendor)":A?"AP Rec (AP)":"Ledger Rec"}),T&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:i==="premium-dark"?"text-xs text-white/20":"text-xs text-gray-300",children:"â€¢"}),e.jsxs("span",{className:"text-xs text-purple-600 flex items-center gap-1",children:[e.jsx(O,{className:"size-3"}),"AI Generated"]})]})]}),e.jsx("p",{className:i==="premium-dark"?"text-white mb-2":"text-gray-900 mb-2",children:v.description}),s.suggested_action&&!T&&e.jsxs("p",{className:i==="premium-dark"?"text-sm text-white/50":"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Suggested Action:"})," ",s.suggested_action]}),T&&e.jsx("div",{className:"mt-4",children:$e===t.id&&k?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-500 text-xs mb-1 block",children:"DEBIT ACCOUNT"}),e.jsx("div",{className:"relative",children:k.debit_account&&!Ae?e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[e.jsx("span",{className:"text-sm text-gray-900",children:k.debit_account}),e.jsx("button",{onClick:()=>J(!0),className:"text-xs text-purple-600 hover:text-purple-700",children:"Change"})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{value:me,onChange:h=>ee(h.target.value),placeholder:"Search account...",className:"h-9 text-sm",onFocus:()=>J(!0)}),Ae&&e.jsx("div",{className:"absolute z-20 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:dt().map(h=>e.jsxs("button",{onClick:()=>ct(`${h.code} - ${h.name}`),className:"w-full text-left px-3 py-2 hover:bg-purple-50 text-sm border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"text-gray-900",children:[h.code," - ",h.name]}),e.jsx("div",{className:"text-xs text-gray-500",children:h.type})]},h.code))})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-500 text-xs mb-1 block",children:"CREDIT ACCOUNT"}),e.jsx("div",{className:"relative",children:k.credit_account&&!Te?e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[e.jsx("span",{className:"text-sm text-gray-900",children:k.credit_account}),e.jsx("button",{onClick:()=>M(!0),className:"text-xs text-purple-600 hover:text-purple-700",children:"Change"})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{value:he,onChange:h=>te(h.target.value),placeholder:"Search account...",className:"h-9 text-sm",onFocus:()=>M(!0)}),Te&&e.jsx("div",{className:"absolute z-20 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:xt().map(h=>e.jsxs("button",{onClick:()=>lt(`${h.code} - ${h.name}`),className:"w-full text-left px-3 py-2 hover:bg-purple-50 text-sm border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"text-gray-900",children:[h.code," - ",h.name]}),e.jsx("div",{className:"text-xs text-gray-500",children:h.type})]},h.code))})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-500 text-xs mb-1 block",children:"AMOUNT"}),e.jsx(w,{type:"number",step:"0.01",value:k.amount,readOnly:!0,disabled:!0,className:"h-9 text-sm bg-gray-100 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-500 text-xs mb-1 block",children:"MEMO"}),e.jsx(w,{value:k.memo,onChange:h=>z(jt=>({...jt,memo:h.target.value})),placeholder:"Optional memo",className:"h-9 text-sm"})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(m,{size:"sm",onClick:()=>ot(t.id),disabled:W[`save-${t.id}`],className:"gap-2 bg-green-600 hover:bg-green-700",children:[W[`save-${t.id}`]?e.jsx(re,{className:"size-3 animate-spin"}):e.jsx($,{className:"size-3"}),"Save Changes"]}),e.jsx(m,{size:"sm",variant:"outline",onClick:it,children:"Cancel"})]})]}):e.jsxs("div",{className:i==="premium-dark"?"border border-white/10 rounded-lg overflow-hidden":"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:i==="premium-dark"?"grid grid-cols-2 gap-0 bg-white/[0.02] border-b border-white/10":"grid grid-cols-2 gap-0 bg-gray-50/50 border-b border-gray-200",children:[e.jsx("div",{className:i==="premium-dark"?"px-3 py-2 text-xs text-white/40":"px-3 py-2 text-xs text-gray-500",children:"DEBIT"}),e.jsx("div",{className:i==="premium-dark"?"px-3 py-2 text-xs text-white/40":"px-3 py-2 text-xs text-gray-500",children:"CREDIT"})]}),e.jsxs("div",{className:i==="premium-dark"?"grid grid-cols-2 gap-0 border-b border-white/10":"grid grid-cols-2 gap-0 border-b border-gray-200",children:[e.jsx("div",{className:i==="premium-dark"?"px-3 py-3 text-sm text-white":"px-3 py-3 text-sm text-gray-900",children:s.suggested_je.debit_account}),e.jsx("div",{className:i==="premium-dark"?"px-3 py-3 text-sm text-white":"px-3 py-3 text-sm text-gray-900",children:s.suggested_je.credit_account})]}),e.jsxs("div",{className:i==="premium-dark"?"px-3 py-2.5 bg-white/[0.01]":"px-3 py-2.5 bg-gray-50/30",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:i==="premium-dark"?"text-white/60":"text-gray-600",children:"Amount:"}),e.jsx("span",{className:i==="premium-dark"?"text-white font-medium":"text-gray-900 font-medium",children:y(s.suggested_je.amount)})]}),s.suggested_je.memo&&e.jsxs("div",{className:i==="premium-dark"?"mt-2 text-xs text-white/50":"mt-2 text-xs text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Memo:"})," ",s.suggested_je.memo]})]})]})})]}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:`text-lg font-medium ${gt?v.amount>=0?"text-red-600":"text-green-600":v.amount>=0?"text-green-600":"text-red-600"}`,children:y(Math.abs(v.amount))})})]}),e.jsx("div",{className:i==="premium-dark"?"flex gap-2 pt-3 border-t border-white/10":"flex gap-2 pt-3 border-t border-gray-200",children:T?e.jsxs(e.Fragment,{children:[e.jsxs(m,{size:"sm",className:i==="premium-dark"?"gap-2 bg-green-500/20 text-green-400 hover:bg-green-500/30 border border-green-500/30 rounded-full":"gap-2 bg-green-600 hover:bg-green-700 rounded-full",onClick:()=>mt(t.id),disabled:W[`approve-${t.id}`],children:[W[`approve-${t.id}`]?e.jsx(re,{className:"size-3 animate-spin"}):e.jsx($,{className:"size-3"}),"Approve & Move to Ready"]}),e.jsx(m,{size:"sm",variant:"outline",className:i==="premium-dark"?"gap-2 border-white/10 hover:bg-white/5 rounded-full text-white":"gap-2 rounded-full",onClick:()=>_e(t),disabled:$e===t.id,children:"Edit Details"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(m,{size:"sm",className:i==="premium-dark"?"gap-2 bg-white text-black hover:bg-white/90 rounded-full":"gap-2 bg-purple-600 hover:bg-purple-700 text-white rounded-full",onClick:Re,disabled:Z||f.length===0,children:[Z?e.jsx(re,{className:"size-3 animate-spin"}):e.jsx(O,{className:"size-3"}),"Generate AI Suggestion"]}),e.jsxs(m,{size:"sm",variant:"outline",className:i==="premium-dark"?"gap-2 border-white/10 hover:bg-white/5 rounded-full text-white":"gap-2 rounded-full",onClick:()=>_e(t),children:[e.jsx(Ue,{className:"size-3"}),"Manually Record"]})]})})]},t.id):(console.error("Transaction is undefined for suggestion:",t),null)})]})})]})}),e.jsx(ye,{value:"ready",children:e.jsxs(R,{children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Q,{children:["Ready to Export (",N.length,")"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Approved entries waiting for export to QuickBooks/Xero/DATEV"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(ae,{children:[e.jsx(ne,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:"gap-2",children:[e.jsx(ue,{className:"size-4"}),"Export to File",e.jsx(ie,{className:"size-4"})]})}),e.jsxs(oe,{align:"end",className:"w-56",children:[e.jsx(g,{onClick:()=>L("csv"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"CSV (Universal)"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Works with any system"})]})}),e.jsx(g,{onClick:()=>L("excel"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"Excel (XLSX)"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Formatted spreadsheet"})]})}),e.jsx(g,{onClick:()=>L("qb-csv"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"QuickBooks CSV"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Ready for QBO import"})]})}),e.jsx(g,{onClick:()=>L("iif"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"IIF Format"}),e.jsx("span",{className:"text-xs text-gray-500",children:"QuickBooks Desktop"})]})}),e.jsx(g,{onClick:()=>L("xero-csv"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"Xero CSV"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Ready for Xero import"})]})}),e.jsx(g,{onClick:()=>L("datev-csv"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"DATEV CSV"}),e.jsx("span",{className:"text-xs text-gray-500",children:"German accounting standard"})]})})]})]}),e.jsxs(m,{className:"gap-2 bg-gradient-to-r from-purple-600 to-violet-600",onClick:ht,disabled:N.length===0,children:[e.jsx($,{className:"size-4"}),"Mark as Posted in QB/Xero/DATEV"]})]})]})}),e.jsx(_,{children:qe?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-purple-600 border-t-transparent mx-auto mb-3"}),"Loading entries..."]}):N.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No journal entries ready for export."}):e.jsx("div",{className:"space-y-4",children:N.map(t=>{const s={debit:t.lines.reduce((r,a)=>r+parseFloat(a.debit||"0"),0),credit:t.lines.reduce((r,a)=>r+parseFloat(a.credit||"0"),0)};return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-purple-200 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"bg-purple-100 text-purple-700 border-purple-200",children:t.createdBy==="AI"?"AI Generated":"Manual"}),e.jsx("span",{className:"text-sm text-gray-500",children:t.id}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(t.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),e.jsx("p",{className:"text-gray-900 mt-1",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{size:"sm",variant:"outline",className:"gap-2",onClick:()=>pt(t),children:[e.jsx(Ue,{className:"size-3"}),"Edit"]}),e.jsxs(q,{className:"bg-green-100 text-green-700 border-green-200",children:[e.jsx($,{className:"size-3 mr-1"}),"Approved"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 text-gray-600 w-1/2",children:"Account"}),e.jsx("th",{className:"text-right py-2 text-gray-600 w-[120px]",children:"Debit"}),e.jsx("th",{className:"text-right py-2 text-gray-600 w-[120px]",children:"Credit"}),e.jsx("th",{className:"text-left py-2 text-gray-600 pl-3",children:"Memo"})]})}),e.jsx("tbody",{children:t.lines.map((r,a)=>e.jsxs("tr",{className:"border-b border-gray-100 last:border-b-0",children:[e.jsxs("td",{className:"py-2 text-gray-900",children:[r.accountCode," - ",r.account]}),e.jsx("td",{className:"py-2 text-right text-gray-900",children:r.debit?y(parseFloat(r.debit)):"-"}),e.jsx("td",{className:"py-2 text-right text-gray-900 pr-3",children:r.credit?y(parseFloat(r.credit)):"-"}),e.jsx("td",{className:"py-2 text-gray-600 pl-3",children:r.memo||"-"})]},a))}),e.jsx("tfoot",{className:"border-t-2 border-gray-200",children:e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 text-gray-600",children:"Total"}),e.jsx("td",{className:"py-2 text-right text-gray-900",children:y(s.debit)}),e.jsx("td",{className:"py-2 text-right text-gray-900",children:y(s.credit)}),e.jsx("td",{})]})})]})})]},t.id)})})})]})}),e.jsx(ye,{value:"posted",children:e.jsxs(R,{children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Q,{children:["Posted in Accounting System (",E.length,")"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Entries successfully posted to QuickBooks/Xero/DATEV - read-only audit trail"})]}),E.length>0&&e.jsxs(ae,{children:[e.jsx(ne,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:"gap-2",children:[e.jsx(ue,{className:"size-4"}),"Re-Export",e.jsx(ie,{className:"size-4"})]})}),e.jsxs(oe,{align:"end",className:"w-56",children:[e.jsx(g,{onClick:()=>P("csv"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"CSV (Universal)"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Works with any system"})]})}),e.jsx(g,{onClick:()=>P("excel"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"Excel (XLSX)"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Formatted spreadsheet"})]})}),e.jsx(g,{onClick:()=>P("qb-csv"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"QuickBooks CSV"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Ready for QBO import"})]})}),e.jsx(g,{onClick:()=>P("iif"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"IIF Format"}),e.jsx("span",{className:"text-xs text-gray-500",children:"QuickBooks Desktop"})]})}),e.jsx(g,{onClick:()=>P("xero-csv"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"Xero CSV"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Ready for Xero import"})]})}),e.jsx(g,{onClick:()=>P("datev-csv"),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:"DATEV CSV"}),e.jsx("span",{className:"text-xs text-gray-500",children:"German accounting standard"})]})})]})]})]})}),e.jsx(_,{children:He?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-purple-600 border-t-transparent mx-auto mb-3"}),"Loading entries..."]}):E.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No entries have been posted to the accounting system yet."}):e.jsx("div",{className:"space-y-4",children:E.map(t=>{const s={debit:t.lines.reduce((r,a)=>r+parseFloat(a.debit||"0"),0),credit:t.lines.reduce((r,a)=>r+parseFloat(a.credit||"0"),0)};return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"bg-blue-100 text-blue-700 border-blue-200",children:t.createdBy==="AI"?"AI Generated":"Manual"}),e.jsx("span",{className:"text-sm text-gray-500",children:t.id}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(t.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),e.jsx("p",{className:"text-gray-900 mt-1",children:t.description}),t.postedAt&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-gray-600",children:[e.jsx($,{className:"size-3 text-green-600"}),e.jsxs("span",{children:["Posted on ",new Date(t.postedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),t.exportHistory&&t.exportHistory.length>0&&e.jsxs("span",{className:"ml-2",children:["â€¢ Last exported as ",t.exportHistory[t.exportHistory.length-1].format.toUpperCase()]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(q,{className:"bg-green-100 text-green-700 border-green-200",children:[e.jsx($,{className:"size-3 mr-1"}),"Posted in System"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 text-gray-600 w-1/2",children:"Account"}),e.jsx("th",{className:"text-right py-2 text-gray-600 w-[120px]",children:"Debit"}),e.jsx("th",{className:"text-right py-2 text-gray-600 w-[120px]",children:"Credit"}),e.jsx("th",{className:"text-left py-2 text-gray-600 pl-3",children:"Memo"})]})}),e.jsx("tbody",{children:t.lines.map((r,a)=>e.jsxs("tr",{className:"border-b border-gray-100 last:border-b-0",children:[e.jsxs("td",{className:"py-2 text-gray-900",children:[r.accountCode," - ",r.account]}),e.jsx("td",{className:"py-2 text-right text-gray-900",children:r.debit?y(parseFloat(r.debit)):"-"}),e.jsx("td",{className:"py-2 text-right text-gray-900 pr-3",children:r.credit?y(parseFloat(r.credit)):"-"}),e.jsx("td",{className:"py-2 text-gray-600 pl-3",children:r.memo||"-"})]},a))}),e.jsx("tfoot",{className:"border-t-2 border-gray-200",children:e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 text-gray-600",children:"Total"}),e.jsx("td",{className:"py-2 text-right text-gray-900",children:y(s.debit)}),e.jsx("td",{className:"py-2 text-right text-gray-900",children:y(s.credit)}),e.jsx("td",{})]})})]})})]},t.id)})})})]})})]})]})}export{Jt as JournalEntries};
